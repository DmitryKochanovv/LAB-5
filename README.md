# LAB-5

ОПИСАНИЕ ЗАДАЧИ:
Разработать консольное приложение с дружественным интерфейсом с возможностью выбора 
заданий. Приложение должно выполнять следующие функции: 
1. Чтение базы данных из excel файла. 
2. Просмотр базы данных. 
3. Удаление элементов (по ключу). 
4. Добавление элементов. 
5. Реализация 4 запросов (формулировки запросов придумать самостоятельно и отразить в 
отчёте, можно использовать запрос, данный в примере): 
1. 1 запрос с обращением к одной таблице 
2. 1 запрос с обращением к двум таблицам 
3. 2 запроса с обращением к трем таблицам 
2 запроса должны возвращать перечень, 2 запроса одно значение. 
6. Сохранение изменений в excel файле. 
Элементами базы данных являются объекты классов согласно вашему варианту. Содержание классов 
определить самостоятельно и отразить в отчете (в классах должны присутствовать свойства, 
конструкторы, перегруженный метод ToString). Весь функционал приложения реализовать в виде 
методов вспомогательного класса с помощью LINQ-запросов. 
Предусмотреть обработку возможных ошибок при работе программы.

СУТЬ: РАЗРАБОТАТЬ КОНСОЛЬНОЕ ПРИЛОЖЕНИЕ КОТОРОЕ МОЖЕТ ВЫПОЛНЯТЬ РАЗЛИЧНЫЙ ФУНКЦИОНАЛ С XLSX ФАЙЛАМИ.

АЛГОРИТМ И РЕАЛИЗАЦИЯ ЗАДАЧИ:

1)СТРУКТУРА БАЗЫ ДАННЫХ СОСТОИТ ИЗ 3 ЛИСТОВ:
1)СТРАНЫ
2)ФУТБОЛЬНЫЕ КЛУБЫ
3)ДОСТИЖЕНИЯ КОМАНДЫ

2)СОЗДАЁМ 4 КЛАССА 

-`Country — страна (Id, Name)
- `Club — клуб (Id, Name, CountryId)
- `Achievement — достижения клуба (медали и кубки)
- `Database — вспомогательный класс для работы с XLSX файлами и LINQ‑запросами

3)ПОСЛЕ СОЗДАНИЯ КЛАССОВ ПРОГРАММА ВЫПОЛНЯЕТ СЧИТЫВАНИЕ ДАННЫХ ИЗ XLSX ФАЙЛА,СОЗДАЁМ 3 СПИСКА ОБЪЕКТОВ.

-`List<Country> Countries — все страны из листа «Страны»
-List<Club> Clubs — все клубы из листа «Клубы»
- `List<Achievement> Achievements — все достижения из листа «Достижения»

Каждый лист XLSX файла алгоритм проходит циклом по каждой строке таблицы, и каждая строка превращается в объект соответствующего класса.  
Так данные из таблиц XLSX файла загружаются, храним в списках,удобно для работы через LINQ‑запросы и методы.

4)РЕАЛИЗАЦИЯ ФУНКЦИОНАЛА:
- просмотр списков,считываем содержимое файла по строкам,формируем списки ,на основе созданных объектов.Выводим перегружая оператор To String
- добавление элементов ,добавляем новый элемент при помощи Add проверяя на определённые условия. Перед написанием цикла стоит учесть,что 1-ая строка содержит заголовки столбцов,начинаем не с 0, а с 1
- удаляем элемент по ключу и всё ,что с ним связано,используем RemoveAll
- обновление достижений,удаляем старые данные,добавляем обновлённые.
- выполнение LINQ‑запросов. сформировать 4 запроса по определенным критериям,связи нескольких таблиц,перечень или определенный параметр.
- сохранение изменений обратно в Excel

5) ТЕСТИРОВАНИЕ ПРОГРАММЫ:

[Скриншоты тестов](./images/)

1)СПИСОК ВСЕХ СТРАН
2)УДАЛЕНИЕ СТРАНЫ
3)ДОБАВЛЕНИЕ СТРАНЫ
4)LINQ2,LINQ22 - КОЛИЧЕСТВО ФУТБОЛЬНЫХ КОМАНД ОПРЕДЕЛЕННОЙ СТРАНЫ


